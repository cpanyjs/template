import{d as S,G as E,H as P,v as T,K as R,y as k,o as u,e as f,g as w,f as _,j as B,h as N,D as U,P as l,V as O}from"./index.a2c74fab.js";import{l as x}from"./load.b9090f49.js";import{c as D}from"./codeforces.a492bc8e.js";import{_ as H,h as V,f as $}from"./Contest.9b090dce.js";import"./c-table.1a32307a.js";import"./user-link.8f4dba0e.js";import"./cf-rating-color.d4a4effa.js";import"./at-rating-color.a6a68dd4.js";const L=x(D),j=new Map;for(const o of L)o.type.startsWith("codeforces")&&j.set(o.id,o);function M(o){var r;return(r=j.get(+o))!=null?r:null}const F="https://codeforces.com/api/",G={key:0},K={key:1,class:"divide-y"},W=_("h2",{class:"mb-2"},"\u9519\u8BEF",-1),q={class:"pt-2"},se=S({setup(o){const r=E(),C=P(),p=T(null),b=T(!1),{start:v,end:g}=R(),A=async s=>{var m,y;v();const a=new URL(F+"contest.standings");a.searchParams.append("contestId",""+s.id),a.searchParams.append("handles",V.map(({h:e})=>e).join(";")),a.searchParams.append("showUnofficial","true");const{result:d}=await(await fetch(a.toString())).json();s.problems=d.problems;for(const e of d.problems)e.problemUrl=`https://codeforces.com/contest/${e.contestId}/problem/${e.index}`;s.standings=[];for(const e of d.rows){if(e.party.participantType!==l.CONTESTANT&&e.party.participantType!==l.VIRTUAL&&e.party.participantType!==l.OUT_OF_COMPETITION&&e.party.participantType!==l.PRACTICE)continue;const I=e.problemResults.reduce((t,n)=>{var i,c;return n.points===0?t:t+((i=n.bestSubmissionTimeSeconds)!=null?i:0)+20*((c=n.rejectedAttemptCount)!=null?c:0)},0),h=(m=e.party.participantTime)!=null?m:s.startTime;s.standings.push({author:{members:e.party.members.map(t=>t.handle),teamName:(y=e.party.teamName)!=null?y:$(e.party.members[0].handle),participantTime:h,participantType:e.party.participantType},rank:e.rank,solved:e.problemResults.filter(t=>t.points>0).length,penalty:I,submissions:e.problemResults.map((t,n)=>{const i=t.bestSubmissionTimeSeconds+h,c=t.bestSubmissionTimeSeconds;return t.points>0?{id:-1,creationTime:i,relativeTime:c,problemIndex:n,verdict:O.OK,dirty:t.rejectedAttemptCount}:t.rejectedAttemptCount>0?{id:-1,creationTime:i,relativeTime:c,problemIndex:n,dirty:t.rejectedAttemptCount}:null}).filter(t=>t!==null)})}g()};return k(()=>r.params,s=>{if(s.id){const a=M(+s.id);if(a!==null)p.value=a,A(p.value),document.title=`${a.name} - CPany`;else{b.value=!0;const m=setTimeout(()=>C.replace({name:"Home"}),3e3);U(()=>clearTimeout(m))}}},{immediate:!0}),(s,a)=>(u(),f("div",null,[p.value&&!b.value?(u(),f("div",G,[w(H,{contest:p.value},null,8,["contest"])])):(u(),f("div",K,[W,_("p",q,"\u672A\u627E\u5230 ID \u4E3A "+B(N(r).params.id)+" \u7684 Codeforces \u6BD4\u8D5B",1)]))]))}});export{se as default};
