import{V as e,P as t}from"./enum.e7b7c68b.js";import{d as a,k as s,j as n,u as r,q as l,o,c as i,a as u,t as c,y as p,F as d,n as m,m as v,b as f,w as b,e as y,g as h,z as g,A as k,f as T,B as x,s as C,i as w,C as _,D as A}from"./index.b1e74543.js";import{l as j}from"./load.53ed3808.js";import{c as N}from"./codeforces.50b29f65.js";import{C as U,a as I}from"./c-table.5f35f1ed.js";import{_ as S}from"./user-link.vue_vue&type=script&setup=true&lang.1b04320e.js";import{_ as q}from"./cf-rating-color.vue_vue&type=script&setup=true&lang.e64a684b.js";const B=j(N),M=new Map;for(const me of B)me.type.startsWith("codeforces")&&M.set(me.id,me);const P=j({keyMaps:[],stringMaps:[["tourist","a"],["Petr","b"],["Benq","c"],["ksun48","d"],["sunset","e"]],data:[{n:"a",h:"a",r:3707},{n:"b",h:"b",r:3229},{n:"c",h:"c",r:3672},{n:"d",h:"d",r:3547},{n:"e",h:"e",r:3338}]}),R=new Map(P.map((e=>[e.h,e.n]))),E=new Map(P.map((e=>[e.h,e.r])));function O(e){var t;return null!=(t=R.get(e))?t:e}function $(e){return E.get(e)}const K={class:"space-left"},F={key:1};var L=a({props:{author:{type:null,required:!0}},setup(e){const t=e,{author:a}=s(t),f=n((()=>{var e,t;return null!=(t=null==(e=null==a?void 0:a.value)?void 0:e.teamUrl)?t:""})),b=()=>{""!==f.value&&window.open(f.value,"_blank")};return(e,t)=>r(l)(r(a).teamName)?(o(),i(d,{key:0},[u("div",{class:p(""!==r(f)&&"cursor-pointer"),onClick:b},c(r(a).teamName),3),u("div",K,[(o(!0),i(d,null,m(r(a).members,((e,t)=>(o(),v(S,{class:p(t>0&&"ml-2"),key:e,name:e},null,8,["class","name"])))),128))])],64)):(o(),i("span",F,c(r(a).members[0]),1))}});const V={class:"space-left"},D=["href"],W={key:1};var z=a({props:{author:{type:null,required:!0}},setup:e=>(t,a)=>r(l)(e.author.teamName)?(o(),i(d,{key:0},[f(S,{name:e.author.teamName},null,8,["name"]),u("span",V,[(o(!0),i(d,null,m(e.author.members,((e,t)=>(o(),i("a",{key:t,class:"ml-2",href:`https://codeforces.com/profile/${e}`,target:"_blank"},[f(r(q),{rating:r($)(e)},{default:b((()=>[y(c(e),1)])),_:2},1032,["rating"])],8,D)))),128))])],64)):(o(),i("span",W,c(e.author.members[0]),1))});const H=u("span",null,"+",-1),G={key:0},J={key:0,class:"text-sm text-gray-400"},Q={key:1},X={class:"text-center font-bold text-red-500"},Y=u("span",null,"-",-1);var Z=a({props:{result:{type:null,required:!1},practice:{type:Boolean,required:!1}},setup(t){const a=t,{result:l}=s(a),m=n((()=>{var e,t;return null!=(t=null==(e=null==l?void 0:l.value)?void 0:e.submissionUrl)?t:""})),v=()=>{""!==m.value&&window.open(m.value,"_blank")};function f(e){const t=Math.floor(e/3600),a=Math.floor(e%3600/60);return`${t}:${s=a,(s<10?"0":"")+s}`;var s}return(a,s)=>{var n;return r(l)?(o(),i(d,{key:0},[r(l).verdict===r(e).OK?(o(),i("div",{key:0,class:p(""!==r(m)&&"cursor-pointer"),onClick:v},[u("div",{class:p(["text-center","font-bold",t.practice?"text-blue-500":"text-green-500"])},[H,r(l).dirty?(o(),i("span",G,c(r(l).dirty),1)):h("v-if",!0)],2),t.practice?h("v-if",!0):(o(),i("div",J,[u("span",null,c(f(r(l).relativeTime)),1)]))],2)):(o(),i("div",Q,[u("div",X,[Y,u("span",null,c(null!=(n=r(l).dirty)?n:1),1)])]))],2112)):h("v-if",!0)}}});const ee={key:0,class:"mt-4 box"},te={key:0,class:"font-600"},ae={key:1,class:"font-600"},se={key:0};var ne=a({props:{contest:{type:null,required:!0}},setup(a){const y=a,{contest:T}=s(y),x=n((()=>T.value.type.startsWith("codeforces"))),C=e=>e.author.participantType===t.PRACTICE,w=e=>"string"==typeof e?e:String.fromCharCode(65+e),_=n((()=>{var e,t;return null!=(t=null==(e=T.value.problems)?void 0:e.sort(((e,t)=>("string"==typeof e.index?e.index.charCodeAt(0)-65:e.index)-("string"==typeof t.index?t.index.charCodeAt(0)-65:t.index))))?t:[]})),A=n((()=>{var t,a,s;if(g(T.value.problems))return{standings:[],firstBlood:[]};if(g(T.value.standings))return{standings:[],firstBlood:[]};const n=Array(null==(t=T.value.problems)?void 0:t.length);for(const r of T.value.standings){const t=Array(null==(a=T.value.problems)?void 0:a.length);for(const a of r.submissions){const l=a.problemIndex;if(a.verdict===e.OK&&!C(r))if(g(n[l]))n[l]=a;else{n[l].relativeTime>a.relativeTime&&(n[l]=a)}if(g(t[l]))t[l]=a;else{const n=t[l];(null!=(s=null==n?void 0:n.verdict)?s:e.FAILED)!==e.OK&&(t[l]=a)}}Reflect.set(r,"result",t)}return{standings:T.value.standings,firstBlood:n}}));return(t,a)=>r(T).standings?(o(),i("div",ee,[f(r(I),{data:r(A).standings,mobile:1080},{columns:b((({row:t})=>[f(r(U),{label:"#",align:"center",width:"4em"},{default:b((()=>[C(t)?(o(),i("span",ae,"-")):(o(),i("span",te,c(t.rank),1))])),_:2},1024),f(r(U),{label:r(x)?"Handle":""},{default:b((()=>[r(x)?(o(),v(z,{key:1,author:t.author},null,8,["author"])):(o(),v(L,{key:0,author:t.author},null,8,["author"]))])),_:2},1032,["label"]),f(r(U),{label:"解决",align:"center",width:"4em"},{default:b((()=>[u("span",null,c(t.solved),1)])),_:2},1024),f(r(U),{label:"罚时",align:"center",width:"4em"},{default:b((()=>[C(t)?h("v-if",!0):(o(),i("span",se,c(r(k)(t.penalty).value),1))])),_:2},1024),(o(!0),i(d,null,m(r(_),((a,s)=>{var n,i;return o(),v(r(U),{key:a.index,label:w(a.index),center:"",class:p(r(l)(t)&&r(l)(r(A).firstBlood[s])&&r(l)(t.result[s])&&t.result[s].verdict===r(e).OK&&t.result[s].relativeTime<=(null!=(i=null==(n=r(A).firstBlood[s])?void 0:n.relativeTime)?i:Number.MIN_VALUE)&&"bg-[#E0FFE4]")},{default:b((()=>[f(Z,{result:t.result[s],practice:C(t)},null,8,["result","practice"])])),_:2},1032,["label","class"])})),128))])),_:1},8,["data"])])):h("v-if",!0)}});const re={class:"mb-4"},le={class:"info-box border-left"},oe={key:0},ie=["href"],ue=["href"];var ce=a({props:{contest:{type:null,required:!0}},setup:e=>(t,a)=>(o(),i("div",null,[u("h2",re,c(e.contest.name),1),u("div",le,[u("p",null," 时间："+c(r(T)(e.contest.startTime).value)+" 至 "+c(r(T)(e.contest.startTime+e.contest.duration).value),1),u("p",null,"时长："+c(r(x)(e.contest.duration).value),1),u("p",null,"人数："+c(e.contest.participantNumber)+" 人",1),e.contest.contestUrl||e.contest.standingsUrl?(o(),i("p",oe,[u("a",{href:e.contest.contestUrl,target:"_blank"},"比赛主页",8,ie),u("a",{href:e.contest.standingsUrl,target:"_blank",class:"ml-2"},"完整榜单",8,ue)])):h("v-if",!0)]),f(ne,{contest:e.contest},null,8,["contest"])]))});const pe={key:0};var de=a({setup(a){const s=C(),n=w(null),{start:r,end:l}=_();return A((()=>s.params),(a=>{if(a.id){const i=(s=+a.id,null!=(o=M.get(+s))?o:null);null!==i&&(n.value=i,(async a=>{var s,n;r();const o=new URL("https://codeforces.com/api/contest.standings");o.searchParams.append("contestId",""+a.id),o.searchParams.append("handles",P.map((({h:e})=>e)).join(";")),o.searchParams.append("showUnofficial","true");const{result:i}=await(await fetch(o.toString())).json();a.problems=i.problems;for(const e of i.problems)e.problemUrl=`https://codeforces.com/contest/${e.contestId}/problem/${e.index}`;a.standings=[];for(const r of i.rows){if(r.party.participantType!==t.CONTESTANT&&r.party.participantType!==t.VIRTUAL&&r.party.participantType!==t.PRACTICE)continue;const l=r.problemResults.reduce(((e,t)=>{var a,s;return 0===t.points?e:e+(null!=(a=t.bestSubmissionTimeSeconds)?a:0)+20*(null!=(s=t.rejectedAttemptCount)?s:0)}),0),o=null!=(s=r.party.participantTime)?s:a.startTime;a.standings.push({author:{members:r.party.members.map((e=>e.handle)),teamName:null!=(n=r.party.teamName)?n:O(r.party.members[0].handle),participantTime:o,participantType:r.party.participantType},rank:r.rank,solved:r.problemResults.filter((e=>e.points>0)).length,penalty:l,submissions:r.problemResults.map(((t,a)=>{const s=t.bestSubmissionTimeSeconds+o,n=t.bestSubmissionTimeSeconds;return t.points>0?{id:-1,creationTime:s,relativeTime:n,problemIndex:a,verdict:e.OK,dirty:t.rejectedAttemptCount}:t.rejectedAttemptCount>0?{id:-1,creationTime:s,relativeTime:n,problemIndex:a,dirty:t.rejectedAttemptCount}:null})).filter((e=>null!==e))})}l()})(n.value),document.title=`${i.name} - CPany`)}var s,o}),{immediate:!0}),(e,t)=>(o(),i("div",null,[n.value?(o(),i("div",pe,[f(ce,{contest:n.value},null,8,["contest"])])):h("v-if",!0)]))}});export{de as default};
