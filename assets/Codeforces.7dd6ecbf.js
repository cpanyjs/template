import{d as S,v as k,x as E,i as h,z as P,k as R,o as u,c as f,b as w,a as _,t as B,u as N,q as U,P as l,V as x}from"./index.33d7da6f.js";import{l as O}from"./load.b9090f49.js";import{c as V}from"./codeforces.9566ad05.js";import{_ as D,h as H,f as $}from"./Contest.ed8d15ca.js";import"./c-table.90603967.js";import"./user-link.ea401553.js";import"./cf-rating-color.84026490.js";import"./at-rating-color.620eb5a6.js";const L=O(V),C=new Map;for(const a of L)a.type.startsWith("codeforces")&&C.set(a.id,a);function M(a){var r;return(r=C.get(+a))!=null?r:null}const F="https://codeforces.com/api/",q={key:0},z={key:1,class:"divide-y"},G=_("h2",{class:"mb-2"},"\u9519\u8BEF",-1),K={class:"pt-2"},se=S({setup(a){const r=k(),j=E(),p=h(null),b=h(!1),{start:v,end:g}=P(),A=async s=>{var m,y;v();const o=new URL(F+"contest.standings");o.searchParams.append("contestId",""+s.id),o.searchParams.append("handles",H.map(({h:e})=>e).join(";")),o.searchParams.append("showUnofficial","true");const{result:d}=await(await fetch(o.toString())).json();s.problems=d.problems;for(const e of d.problems)e.problemUrl=`https://codeforces.com/contest/${e.contestId}/problem/${e.index}`;s.standings=[];for(const e of d.rows){if(e.party.participantType!==l.CONTESTANT&&e.party.participantType!==l.VIRTUAL&&e.party.participantType!==l.OUT_OF_COMPETITION&&e.party.participantType!==l.PRACTICE)continue;const I=e.problemResults.reduce((t,n)=>{var i,c;return n.points===0?t:t+((i=n.bestSubmissionTimeSeconds)!=null?i:0)+20*((c=n.rejectedAttemptCount)!=null?c:0)},0),T=(m=e.party.participantTime)!=null?m:s.startTime;s.standings.push({author:{members:e.party.members.map(t=>t.handle),teamName:(y=e.party.teamName)!=null?y:$(e.party.members[0].handle),participantTime:T,participantType:e.party.participantType},rank:e.rank,solved:e.problemResults.filter(t=>t.points>0).length,penalty:I,submissions:e.problemResults.map((t,n)=>{const i=t.bestSubmissionTimeSeconds+T,c=t.bestSubmissionTimeSeconds;return t.points>0?{id:-1,creationTime:i,relativeTime:c,problemIndex:n,verdict:x.OK,dirty:t.rejectedAttemptCount}:t.rejectedAttemptCount>0?{id:-1,creationTime:i,relativeTime:c,problemIndex:n,dirty:t.rejectedAttemptCount}:null}).filter(t=>t!==null)})}g()};return R(()=>r.params,s=>{if(s.id){const o=M(+s.id);if(o!==null)p.value=o,A(p.value),document.title=`${o.name} - CPany`;else{b.value=!0;const m=setTimeout(()=>j.replace({name:"Home"}),3e3);U(()=>clearTimeout(m))}}},{immediate:!0}),(s,o)=>(u(),f("div",null,[p.value&&!b.value?(u(),f("div",q,[w(D,{contest:p.value},null,8,["contest"])])):(u(),f("div",z,[G,_("p",K,"\u672A\u627E\u5230 ID \u4E3A "+B(N(r).params.id)+" \u7684 Codeforces \u6BD4\u8D5B",1)]))]))}});export{se as default};
