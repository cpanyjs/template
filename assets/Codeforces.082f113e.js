import{d as S,G as E,K as N,v as T,N as P,y as R,o as u,e as f,g as k,f as _,j as w,h as B,D as U,P as l,V as O}from"./index.ef840f6f.js";import{l as x}from"./load.b9090f49.js";import{c as D}from"./codeforces.022267d4.js";import{_ as V,h as H,f as $}from"./Contest.dfced11d.js";import"./c-table.a8f716cd.js";import"./user-link.1c7467b0.js";import"./cf-rating-color.cfe8ae60.js";import"./at-rating-color.1d9facec.js";const L=x(D),j=new Map;for(const a of L)a.type.startsWith("codeforces")&&j.set(a.id,a);function M(a){var r;return(r=j.get(+a))!=null?r:null}const F="https://codeforces.com/api/",G={key:0},K={key:1,class:"divide-y"},W=_("h2",{class:"mb-2"},"\u9519\u8BEF",-1),q={class:"pt-2"},se=S({setup(a){const r=E(),C=N(),p=T(null),y=T(!1),{start:v,end:g}=P(),A=async s=>{var m,b;v();const o=new URL(F+"contest.standings");o.searchParams.append("contestId",""+s.id),o.searchParams.append("handles",H.map(({h:e})=>e).join(";")),o.searchParams.append("showUnofficial","true");const{result:d}=await(await fetch(o.toString())).json();s.problems=d.problems;for(const e of d.problems)e.problemUrl=`https://codeforces.com/contest/${e.contestId}/problem/${e.index}`;s.standings=[];for(const e of d.rows){if(e.party.participantType!==l.CONTESTANT&&e.party.participantType!==l.VIRTUAL&&e.party.participantType!==l.OUT_OF_COMPETITION&&e.party.participantType!==l.PRACTICE)continue;const I=e.problemResults.reduce((t,n)=>{var i,c;return n.points===0?t:t+((i=n.bestSubmissionTimeSeconds)!=null?i:0)+20*((c=n.rejectedAttemptCount)!=null?c:0)},0),h=(m=e.party.participantTime)!=null?m:s.startTime;s.standings.push({author:{members:e.party.members.map(t=>t.handle),teamName:(b=e.party.teamName)!=null?b:$(e.party.members[0].handle),participantTime:h,participantType:e.party.participantType},rank:e.rank,solved:e.problemResults.filter(t=>t.points>0).length,penalty:I,submissions:e.problemResults.map((t,n)=>{const i=t.bestSubmissionTimeSeconds+h,c=t.bestSubmissionTimeSeconds;return t.points>0?{id:-1,creationTime:i,relativeTime:c,problemIndex:n,verdict:O.OK,dirty:t.rejectedAttemptCount}:t.rejectedAttemptCount>0?{id:-1,creationTime:i,relativeTime:c,problemIndex:n,dirty:t.rejectedAttemptCount}:null}).filter(t=>t!==null)})}g()};return R(()=>r.params,s=>{if(s.id){const o=M(+s.id);if(o!==null)p.value=o,A(p.value),document.title=`${o.name} - CPany`;else{y.value=!0;const m=setTimeout(()=>C.replace({name:"Home"}),3e3);U(()=>clearTimeout(m))}}},{immediate:!0}),(s,o)=>(u(),f("div",null,[p.value&&!y.value?(u(),f("div",G,[k(V,{contest:p.value},null,8,["contest"])])):(u(),f("div",K,[W,_("p",q,"\u672A\u627E\u5230 ID \u4E3A "+w(B(r).params.id)+" \u7684 Codeforces \u6BD4\u8D5B",1)]))]))}});export{se as default};
